!function(a){"use strict";function e(b){var c=g(b);return this.each(function(){function l(b){var c=b.children();c.each(function(b){a(this).hasClass("fm-sub")?n(this,c.eq(b+1)):m(this)})}function m(b){var j,n,o,w,x,d=a(b),e=d.children("a"),f=e.children(".fm-icon"),g=e.children(".fm-label"),k=null,l='<div class="fm-mask"></div>',m='<div class="fm-hit"></div>',p=h?"right":"left",r=40,s=!1,t={},u={},v={},y=c.labelAnim.show[0],z=c.labelAnim.show[1],A=c.labelAnim.hide[0],B=c.labelAnim.hide[1];if(c.labelsOn&&g.length){switch(n=i(f.css("width")),o=g.outerWidth(!0),"round"!==c.shape&&"rounded"!==c.shape||(s=!0),c.labelConnected||!c.labelSpace&&"round"!==c.shape&&"rounded"!==c.shape&&"rounded-out"!==c.shape||(k=a(m).appendTo(e)),c.labelEffect){case"fade":t={opacity:0},u={opacity:1},g.css(t),w=function(){k&&k.addClass("fm-show"),g.velocity("stop").addClass("fm-show").velocity(u,y,z)},x=function(){g.velocity("stop").velocity(t,A,B,function(){g.removeClass("fm-show"),k&&k.removeClass("fm-show")})};break;case"slide-out":case"slide-out-fade":j=e.wrap(l).parent(),j.css("width",n),s&&j.addClass("fm-off"),t[p]=-o+n,c.labelConnected?u[p]=0:u[p]=n,"slide-out-fade"===c.labelEffect&&(t.opacity=0,u.opacity=1),g.css(t),w=function(){j.css("width",n+o),s&&j.removeClass("fm-off"),k&&k.addClass("fm-show"),g.velocity("stop").addClass("fm-show").velocity(u,y,z)},x=function(){g.velocity("stop").velocity(t,A,B,function(){g.removeClass("fm-show"),j.css("width",n),s&&j.addClass("fm-off"),k&&k.removeClass("fm-show")})};break;case"slide-in":t={opacity:0},t[p]=n+r,u={opacity:1},u[p]=n,g.css(t),w=function(){k&&k.addClass("fm-show"),g.velocity("stop").addClass("fm-show").velocity(u,y,z)},x=function(){g.velocity("stop").velocity(t,A,B,function(){g.removeClass("fm-show"),k&&k.removeClass("fm-show")})};break;case"slide-out-out":case"slide-in-in":j=e.wrap(l).parent(),j.css("width",n),s&&j.addClass("fm-off"),"slide-out-out"===c.labelEffect?(t[p]=-o+n,u[p]=n,v[p]=n+r):(t[p]=n+r,u[p]=n,v[p]=-o+n),t.opacity=0,u.opacity=1,v.opacity=0,w=function(){j.css("width",n+o+r),s&&j.removeClass("fm-off"),k&&k.addClass("fm-show"),g.velocity("stop").css(t).addClass("fm-show").velocity(u,y,z,function(){j.css("width",n+o)})},x=function(){j.css("width",n+o+r),g.velocity("stop").velocity(v,A,B,function(){g.removeClass("fm-show"),j.css("width",n),s&&j.addClass("fm-off"),k&&k.removeClass("fm-show")})};break;default:w=function(){k&&k.addClass("fm-show"),g.addClass("fm-show")},x=function(){g.removeClass("fm-show"),k&&k.removeClass("fm-show")}}e.on("mouseenter",w),e.on("mouseleave",x)}var C=e.attr("href");C&&"#"===C.charAt(0)&&e.on("click",function(){return q(C),!1})}function n(b,d){function T(){clearInterval(v)}var d,v,w,x,y,A,b=a(b),e=b.children(".fm-icon"),f=b.children("ul"),g=f.children(),j=null,k='<div class="fm-subhit"></div>',m=c.subPosition[0],n=c.subEffect,o=h?"right":"left",p=g.length,q=i(e.css("width")),r=i(e.css("height")),s=[],t={},u={},z=0,B=c.subAnim.show[0],C=c.subAnim.show[1],D=c.subAnim.hide[0],E=c.subAnim.hide[1];if(l(f),"side"===m&&b.addClass("fm-side"),c.subSpace&&b.addClass("fm-sub-space"),"linear-slide"!==n&&"circular"!==m||b.addClass("fm-posabs"),("under"===m&&"linear-slide"===n||"circular"===m&&"slide"===n||"circular"===m&&"linear-slide"===n)&&g.each(function(b){a(this).css("z-index",100-b)}),d&&(d=a(d),A=i(d.css("margin-top"))),"circular"===m){b.addClass("fm-circular");var L,M,N,O,F=c.subPosition[1],G=c.subPosition[2],H=c.subPosition[3],I=G*Math.PI/180,J=H*Math.PI/180,K=(J-I)/(p-1);g.each(function(b){L=b*K+I,M=Math.round(F*Math.cos(L)),N=Math.round(F*Math.sin(L)),O={top:N},O[o]=M,a(this).css(O),s[b]=[M,N]}),j=a(k).appendTo(b),j.css({width:F+q,height:2*F+q,"border-radius":h?F+"px 0 0 "+F+"px":"0 "+F+"px "+F+"px 0",top:-F}),d.length&&(z=F+3)}else{if("linear-slide"===n){var P=0;g.each(function(b){var c=a(this);c.css("top",P),s[b]=P,P+=i(c.css("height"))+i(c.css("margin-bottom"))}),f.css({width:q,height:P})}j=a(k).appendTo(b),"side"===m?j.css({width:q+i(f.css("margin-"+o)),height:r}):j.css({width:q,height:r+i(f.css("margin-top"))}),"under"===m&&d.length&&(z=f.outerHeight(!0)+i(d.css("margin-top"))+i(f.css("margin-top")))}switch(f.addClass("fm-hide"),n){case"fade":t={opacity:0},u={opacity:1},f.css(t),w=function(){f.velocity("stop").removeClass("fm-hide").velocity(u,B,C)},x=function(){f.velocity("stop").velocity(t,D,E,function(){f.addClass("fm-hide")})};break;case"slide":"circular"===m?(t={top:0,opacity:0},t[o]=0,g.css(t),w=function(){f.removeClass("fm-hide"),g.each(function(b){u={top:s[b][1],opacity:1},u[o]=s[b][0],a(this).velocity("stop").velocity(u,B,C)})},x=function(){g.each(function(b){a(this).velocity("stop").velocity(t,D,E,function(){b===p-1&&f.addClass("fm-hide")})})}):("side"===m?(t[o]=0,u[o]=q):(t={top:0},u={top:42}),t.opacity=0,u.opacity=1,f.css(t),w=function(){f.velocity("stop").removeClass("fm-hide").velocity(u,B,C)},x=function(){f.velocity("stop").velocity(t,D,E,function(){f.addClass("fm-hide")})});break;case"linear-fade":t={opacity:0},u={opacity:1},g.css(t),w=function(){f.removeClass("fm-hide"),T(),y=0,v=setInterval(function(){g.eq(y).velocity("stop").velocity(u,B,C),y===p-1?T():y++},c.subAnim.show[2])},x=function(){T(),y=p-1,v=setInterval(function(){g.eq(y).velocity("stop").velocity(t,B,C,function(){0===y&&f.addClass("fm-hide")}),0===y?T():y--},c.subAnim.hide[2])};break;case"linear-slide":var Q,R,S;"side"===m?t[o]=-q:"circular"===m?(t={top:0},t[o]=0):t={top:-r},t.opacity=0,g.css(t),w=function(){f.removeClass("fm-hide"),T(),y=0,v=setInterval(function(){"side"===m?u[o]=0:"circular"===m?(u={top:s[y][1]},u[o]=s[y][0]):u={top:s[y]},u.opacity=1,g.eq(y).velocity("stop").velocity(u,B,C),y===p-1?T():y++},c.subAnim.show[2])},x=function(){"side"===m||"circular"===m?(Q=0,R=p-1,S=1):(Q=p-1,R=0,S=-1),T(),y=Q,v=setInterval(function(){g.eq(y).velocity("stop").velocity(t,B,C,function(){y===R&&f.addClass("fm-hide")}),y===R?T():y+=S},c.subAnim.hide[2])};break;default:w=function(){f.removeClass("fm-hide")},x=function(){f.addClass("fm-hide")}}b.on("mouseenter",function(){w(),j&&j.addClass("fm-show"),z&&d.velocity("stop").velocity({"margin-top":z},B,C)}),b.on("mouseleave",function(){x(),j&&j.removeClass("fm-show"),z&&d.velocity("stop").velocity({"margin-top":A},B,C)})}function o(){var b=a(this);b.find(".fm-close").on("click",r);var c=b.find("form");c.length&&p(c)}function p(b){function l(){i||m()}function m(){var b=!0;d.each(function(){var c=a(this),d=!0;""===c.val()&&(b=d=!1),"email"!==c.attr("name")||j(c.val())||(b=d=!1),d||(c.addClass("fm-fielderror"),c.on("focus",function(){a(this).removeClass("fm-fielderror").off("focus")}))}),b?(n(),p("working")):p("formerror")}function n(){i=!0;var e={};d.each(function(){var b=a(this);e[b.attr("name")]=b.val()}),e.to=c.mailTo,a.ajax({type:"POST",url:b.attr("action"),data:e,dataType:"json",success:function(a){a.status?(p("success"),o()):p("error"),i=!1}})}function o(){d.each(function(){a(this).val("")})}function p(a){k?f.removeClass("fm-"+k):f.addClass("fm-showstatus"),f.addClass("fm-"+a),k=a}var d=b.find("input, textarea"),e=b.find(".fm-submit"),f=b.find(".fm-status"),i=(f.children(".fm-sicon"),f.children(".fm-message").children(),!1),k=null;e.on("click",l),b.on("submit",function(a){l(),a.preventDefault()})}function q(b){e.addClass("fm-show"),k=a(b).addClass("fm-show"),v(k)}function r(){e.removeClass("fm-show"),k.removeClass("fm-show"),k=null}function s(){u(),k&&v(k)}function t(){s()}function u(){w(d,c.position,c.offset)}function v(a){w(k,c.windowPosition,c.windowOffset)}function w(b,c,d){if(c){var k,l,m,e=g.width(),f=g.height(),h=b.outerWidth(!0),j=b.outerHeight(!0);"number"==typeof c[0]?k={left:c[0]+d[0]}:"string"==typeof c[0]&&(c[0].indexOf("%")!==-1?(m=i(c[0].split("%")[0]),k={left:m/100*e+d[0]}):k="left"===c[0]?{left:0+d[0]}:"center"===c[0]?{left:(e-h)/2+d[0]}:"right"===c[0]?{right:0+d[0]}:{left:i(c[0])+d[0]}),"number"==typeof c[1]?l={top:c[1]+d[1]}:"string"==typeof c[1]&&(c[1].indexOf("%")!==-1?(m=i(c[1].split("%")[0]),l={top:m/100*f+d[1]}):l="top"===c[1]?{top:0+d[1]}:"center"===c[1]?{top:(f-j)/2+d[1]}:"bottom"===c[1]?{bottom:0+d[1]}:{top:i(c[1])+d[1]}),b.css(a.extend({},k,l))}}var b=a(this);b.data("fm-built")&&f.apply(this),b.data("fm-built",!0);var d=b.children(".fm-bar"),e=b.children(".fm-window"),g=a(window),h=!1,k=null;"right"===c.position[0]&&(h=!0,d.addClass("fm-right")),"square"!==c.shape&&d.addClass("fm-"+c.shape),c.labelConnected&&d.addClass("fm-connected"),"default"!==c.color&&d.addClass("fm-"+c.color),"default"!==c.overColor&&d.addClass("fm-"+c.overColor+"-over"),c.sideSpace&&d.addClass("fm-side-space"),c.buttonSpace&&d.addClass("fm-button-space"),c.labelSpace&&d.addClass("fm-label-space"),"round"===c.windowCorners&&e.addClass("fm-round"),"default"!==c.windowColor&&e.addClass("fm-"+c.windowColor),c.windowShadow&&e.addClass("fm-winshadow"),l(d),e.children(".fm-shadow").on("click",r),e.children(".fm-panel").each(o),s(),g.on("resize.floatingMenu",t),b.addClass("fm-ready")})}function f(){return this.each(function(){function e(b){b.children().each(function(){a(this).hasClass("fm-sub")?g(this):f(this)})}function f(b){var c=a(b),d=c.find("a"),e=d.children(".fm-label");d.children(".fm-hit").remove(),c.children(".fm-mask").length&&d.unwrap(),e.removeAttr("style"),d.off("mouseenter mouseleave click")}function g(b){var b=a(b),c=b.children("ul");b.removeClass("fm-side fm-circular fm-sub-space fm-posabs"),c.removeClass("fm-hide"),c.removeAttr("style"),c.children().removeAttr("style"),b.children(".fm-subhit").remove(),b.off("mouseenter mouseleave")}function h(){var b=a(this);b.find(".fm-close").off("click");var c=b.find("form");c.length&&i(c)}function i(b){var c=b.find("input, textarea");b.find(".fm-submit").off("click"),b.off("submit"),c.removeClass("fm-formerror").off("focus"),c.each(function(){a(this).val("")}),b.find(".fm-status").attr("class","fm-status")}var c,d,b=a(this);b.data("fm-built")&&(b.data("fm-built",!1),c=b.children(".fm-bar"),d=b.children(".fm-window"),c.attr("class","fm-bar").removeAttr("style"),d.attr("class","fm-window"),e(c),d.removeClass("fm-show"),d.children(".fm-shadow").off("click"),d.children(".fm-panel").removeClass("fm-show").removeAttr("style").each(h),a(window).off("resize.floatingMenu"),b.removeClass("fm-ready"))})}function g(d){var e=a.extend({},b,d);return"string"==typeof e.position&&(e.position=e.position.split("-")),"center"===e.position[0]&&(e.position[0]=b.position[0],h('Bar horizontal position cannot be "center". Horizontal position reset to "left".')),e.position[1]||(e.position[1]=b.position[1]),0!==e.offset&&e.offset!==!1||(e.offset=[0,0]),"square"!==e.shape&&"round"!==e.shape&&"rounded"!==e.shape&&"rounded-out"!==e.shape&&(e.shape="square"),e.labelConnected&&("slide-in"===e.labelEffect||"slide-out-out"===e.labelEffect||"slide-in-in"===e.labelEffect?(e.labelConnected=!1,h('"labelConnected: true" incompatible with "labelEffect: '+e.labelEffect+'". "labelConnected" reset to false.')):e.labelSpace&&(e.labelSpace=!1,h('"labelSpace: true" incompatible with "labelConnected: true". "labelSpace" reset to false.'))),"slide"===e.labelEffect&&(e.labelEffect="slide-out"),"slide-in-fade"===e.labelEffect&&(e.labelEffect="slide-in"),"default"===e.labelAnim&&(c[e.labelEffect]?e.labelAnim=c[e.labelEffect]:e.labelAnim=c.default),"[object Array]"===Object.prototype.toString.call(e.labelAnim)&&(e.labelAnim={show:e.labelAnim,hide:e.labelAnim}),"string"==typeof e.subPosition&&(e.subPosition=[e.subPosition]),"circular"===e.subPosition[0]&&(e.subPosition[1]||(e.subPosition[1]=b.subPosition[1]),"undefined"==typeof e.subPosition[2]&&(e.subPosition[2]=b.subPosition[2]),"undefined"==typeof e.subPosition[3]&&(e.subPosition[3]=b.subPosition[3]),e.subSpace&&(e.subSpace=!1)),"default"===e.subAnim&&(e.subAnim=b.SubAnim),"linear-fade"!==e.subEffect&&"linear-slide"!==e.subEffect||e.subAnim[2]||(e.subAnim[2]=b.subAnim[2]),"[object Array]"===Object.prototype.toString.call(e.subAnim)&&(e.subAnim={show:e.subAnim,hide:e.subAnim}),"string"==typeof e.windowPosition&&(e.windowPosition=e.windowPosition.split("-")),e.windowPosition[1]||(e.windowPosition[1]=b.windowPosition[1]),0!==e.windowOffset&&e.windowOffset!==!1||(e.windowOffset=[0,0]),"match"===e.windowCorners&&("round"!==e.shape&&"rounded"!==e.shape&&"rounded-out"!==e.shape||(e.windowCorners="round")),"match"===e.windowColor&&(e.windowColor=e.color),e}function h(a){window.console&&console.log("! Floating Menu: "+a)}function i(a){return parseInt(a,10)}function j(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}var b={position:["left","center"],offset:[0,0],shape:"square",sideSpace:!1,buttonSpace:!1,labelSpace:!1,labelConnected:!1,labelEffect:"slide-out",labelAnim:"default",color:"default",overColor:"default",labelsOn:!0,subPosition:["under",100,-90,90],subSpace:!1,subEffect:"fade",subAnim:[400,"easeOutQuad",20],windowPosition:["center","18%"],windowOffset:[0,0],windowCorners:"match",windowColor:"match",windowShadow:!1,mailTo:""},c={default:[400,"easeOutQuad"],fade:[200,"easeOutQuad"],"slide-in-in":{show:[400,"easeOutQuad"],hide:[400,"swing"]}},d={build:e,destroy:f};a.fn.floatingMenu=function(b){"object"!=typeof b&&b?d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):a.error("The method "+b+" does not exist in Floating Menu."):e.apply(this,arguments)}}(jQuery);